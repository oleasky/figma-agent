---
phase: 1-foundation
plan: 01
type: execute
---

<objective>
Set up project structure, archive old specs, and establish conventions for knowledge modules and skills.

Purpose: Create the directory structure and conventions that all subsequent phases depend on. Archive superseded specs so the project starts clean.
Output: `archive/`, `knowledge/`, `commands/figma/` directories with READMEs; project-level CLAUDE.md; archived old specs.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**No prior phase summaries** (this is Phase 1).

**Codebase state:**
- 3 markdown specs at root: `initial-agent.md`, `initial-agent-audit.md`, `agent-rewritten-01.md`
- No `package.json`, no source code, no existing directories besides `.planning/` and `.vscode/`
- Claude Code commands live at `~/.claude/commands/` — existing `gsd` directory confirms convention

**Key decisions from PROJECT.md:**
- Delivery: Claude Code skills installed to `~/.claude/commands/figma/` and knowledge @referenced from skills
- Architecture: Hybrid single-agent with modular skills
- CSS Strategy: Layered (Tailwind bones + CSS Custom Properties tokens + CSS Modules skin)
- Existing specs: Archive and rebuild from scratch using real-world production patterns
- Consumer: Primary consumer is Claude Code via @file references and /skill invocation

**Constraints:**
- No secrets in any file (use placeholders per global CLAUDE.md)
- Knowledge files must be self-contained enough to be @referenced independently
- Skills must declare their @references explicitly
</context>

<tasks>

<task type="auto">
  <name>Task 1: Archive old specs and create directory structure</name>
  <files>archive/initial-agent.md, archive/initial-agent-audit.md, archive/agent-rewritten-01.md, archive/README.md, knowledge/, commands/figma/</files>
  <action>
1. Create `archive/` directory at project root.
2. Move (git mv) the 3 existing specs into `archive/`:
   - `initial-agent.md` → `archive/initial-agent.md`
   - `initial-agent-audit.md` → `archive/initial-agent-audit.md`
   - `agent-rewritten-01.md` → `archive/agent-rewritten-01.md`
3. Create `archive/README.md` with brief explanation: these are superseded specs from the initial agent design, kept for historical reference. The audit identified 6 major issues. The rewritten spec corrected them but still missed real-world production patterns. All have been superseded by the modular knowledge base in `knowledge/`.
4. Create `knowledge/` directory at project root.
5. Create `knowledge/README.md` documenting:
   - Purpose: Modular knowledge files optimized for Claude Code @file reference consumption
   - Naming convention: `{domain}-{topic}.md` (e.g., `figma-api-rest.md`, `design-to-code-layout.md`)
   - Structure convention for each file: title, purpose statement, when to use, the knowledge content, cross-references to related modules
   - List of planned modules (from ROADMAP.md phases 2-6)
   - Note: Each file must be self-contained enough to be @referenced independently
6. Create `commands/figma/` directory structure.
7. Create `commands/figma/README.md` documenting:
   - Purpose: Claude Code invokable skills for Figma design-to-code workflows
   - How skills work: installed to `~/.claude/commands/figma/`, invoked via `/figma:skill-name`
   - Each skill @references relevant knowledge files from `knowledge/`
   - List of planned skills (from ROADMAP.md Phase 7)
   - Convention: Skills are markdown prompt files that declare @references at the top

Do NOT create a `package.json` or any runtime configuration — this project is a knowledge base, not an executable application.
  </action>
  <verify>
- `ls archive/` shows 4 files (3 specs + README.md)
- `ls knowledge/` shows README.md
- `ls commands/figma/` shows README.md
- `git status` shows renamed files (git mv preserves history)
  </verify>
  <done>Old specs archived with git history preserved. knowledge/ and commands/figma/ directories created with convention READMEs. No specs remain at project root.</done>
</task>

<task type="auto">
  <name>Task 2: Create project CLAUDE.md</name>
  <files>CLAUDE.md</files>
  <action>
Create a project-level `CLAUDE.md` at the repository root that serves as the entry point for Claude Code when working with this agent in any project.

The CLAUDE.md should contain:

1. **Header**: "Figma Agent — Knowledge Base & Skills" with one-line description of what this is.

2. **What This Agent Does** section: Brief explanation that this is THE authoritative source of Figma design-to-code knowledge, encoding production patterns from a production Figma plugin and PayloadCMS integration patterns from a reference project. Used by Claude Code as an expert reference for Figma plugin development, design-to-code generation, and CMS integration.

3. **Knowledge Modules** section: Table listing each knowledge module path, its domain, and when to @reference it. Include all planned modules from the roadmap even though they don't exist yet — mark unbuilt ones with "(coming)" so users know what's planned. Categories:
   - Figma API (REST, Plugin, Variables, Webhooks, Dev Mode)
   - Design-to-Code (Layout, Visual, Typography, Assets, Semantic HTML)
   - CSS Strategy & Tokens (CSS strategy, design tokens, Figma variables)
   - PayloadCMS (blocks, Figma mapping, visual builder)
   - Plugin Development (architecture, codegen, best practices)

4. **Skills** section: Table listing each skill command, what it does, and which knowledge modules it @references. Mark as "(coming)" for unbuilt skills.

5. **Usage** section: How to use in other projects:
   - @reference individual knowledge files: `@/path/to/figma-agent/knowledge/figma-api-rest.md`
   - Install skills: `./install.sh` or manual symlink to `~/.claude/commands/figma/`
   - Reference in project CLAUDE.md: add path to this repo's knowledge files

6. **CSS Strategy** section: Brief summary of the layered approach (Tailwind bones + CSS Custom Properties tokens + CSS Modules skin) with pointer to `knowledge/css-strategy.md` for full details.

7. **Source Codebases** section: Brief note that knowledge is extracted from:
   - A production Figma plugin (extract → interpret → export)
   - A PayloadCMS + Next.js project with visual builder plugin
   - Figma developer documentation (2025/2026)

Keep the file concise — under 150 lines. This is an index/guide, not the knowledge itself.
  </action>
  <verify>
- `wc -l CLAUDE.md` is under 150 lines
- File contains all 7 sections
- No secrets or credentials present
- All knowledge module paths use correct naming convention from knowledge/README.md
  </verify>
  <done>CLAUDE.md exists at project root with complete index of knowledge modules, skills, usage guide, and CSS strategy summary. Under 150 lines. No secrets.</done>
</task>

<task type="auto">
  <name>Task 3: Create .env.example and update STATE.md</name>
  <files>.env.example, .gitignore, .planning/STATE.md</files>
  <action>
1. Create `.env.example` with placeholder values for planned integrations:
   ```
   # Figma API Authentication
   FIGMA_TOKEN=YOUR_FIGMA_TOKEN_HERE

   # Figma Webhooks (optional - for webhook verification)
   FIGMA_WEBHOOK_SECRET=YOUR_WEBHOOK_SECRET_HERE
   ```
   Use only the placeholder format from the global CLAUDE.md secrets policy.

2. Create `.gitignore` with standard entries:
   - `.env` and `.env.local` (protect secrets)
   - `.DS_Store`
   - `node_modules/` (future-proofing)
   - Any editor artifacts (`*.swp`, `.idea/`)
   - Do NOT ignore `.planning/` or `.vscode/` (these are tracked)

3. Update `.planning/STATE.md`:
   - Set Current Phase to "1 - Foundation & Archive"
   - Set Phase Status to "in_progress" for Phase 1
   - Set Started date to today for Phase 1
   - Set Next Action to "Execute Phase 1"
  </action>
  <verify>
- `cat .env.example` shows placeholder values (no real secrets)
- `cat .gitignore` includes `.env` and `.DS_Store`
- `grep "in_progress" .planning/STATE.md` matches Phase 1
  </verify>
  <done>.env.example with safe placeholders, .gitignore protecting secrets, STATE.md reflecting Phase 1 in progress.</done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `ls archive/` shows 3 archived specs + README.md
- [ ] `ls knowledge/` shows README.md with conventions
- [ ] `ls commands/figma/` shows README.md with conventions
- [ ] `cat CLAUDE.md` has all 7 sections, under 150 lines
- [ ] `cat .env.example` uses safe placeholder format
- [ ] `cat .gitignore` protects .env files
- [ ] No specs remain at project root (only CLAUDE.md, .env.example, .gitignore)
- [ ] `git log --oneline` shows archive as renames (history preserved)
- [ ] STATE.md reflects Phase 1 in progress
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Old specs archived with git history preserved
- Directory structure established: archive/, knowledge/, commands/figma/
- CLAUDE.md serves as complete index/guide to the agent
- .env.example uses safe placeholders (no real secrets)
- .gitignore protects environment files
- STATE.md updated to reflect Phase 1 progress
- Phase 1 complete — all subsequent phases can use established conventions
</success_criteria>

<output>
After completion, create `.planning/phases/1-foundation/01-01-SUMMARY.md`:

# Phase 1 Plan 01: Foundation & Archive Summary

**[Substantive one-liner]**

## Accomplishments

- [Key outcomes]

## Files Created/Modified

- [File list with descriptions]

## Decisions Made

[Any decisions made during execution]

## Issues Encountered

[Any issues]

## Next Phase Readiness

[Ready for Phases 2-6 which can run in parallel]
</output>
